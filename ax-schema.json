{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://example.org/schemas/ax-schema.json",
  "title": "Agent Discovery Exchange (AX) Document",
  "type": "object",
  "additionalProperties": true,

  "required": ["record_type", "version", "agent", "endpoints"],

  "properties": {
    "record_type": {
      "type": "string",
      "const": "AX",
      "description": "Fixed identifier for Agent Discovery Exchange documents."
    },

    "version": {
      "type": "string",
      "minLength": 1,
      "description": "AX document version identifier (e.g., '1.0')."
    },

    "agent": {
      "type": "object",
      "additionalProperties": true,
      "required": ["name", "description"],
      "properties": {
        "name": { "type": "string", "minLength": 1 },
        "description": { "type": "string", "minLength": 1 },
        "provider": { "type": "string", "minLength": 1 }
      }
    },

    "endpoints": {
      "type": "array",
      "minItems": 1,
      "items": {
        "type": "object",
        "additionalProperties": true,
        "required": ["protocol", "url"],
        "properties": {
          "protocol": {
            "type": "string",
            "minLength": 1,
            "description": "Protocol identifier (e.g., 'graphql', 'mcp', 'a2a', 'rest')."
          },
          "url": {
            "type": "string",
            "format": "uri",
            "minLength": 1,
            "description": "Invocation endpoint URL for the given protocol."
          },
          "auth": {
            "type": "array",
            "items": { "type": "string", "minLength": 1 },
            "description": "Supported authentication mechanisms (e.g., 'OIDC', 'AWS_IAM', 'OAuth2', 'mTLS', 'JWT')."
          },
          "content_type": {
            "type": "string",
            "minLength": 1,
            "description": "Expected request content type where applicable (e.g., 'application/json')."
          }
        }
      }
    },

    "capabilities": {
      "type": "object",
      "additionalProperties": true,
      "properties": {
        "intents": {
          "type": "array",
          "items": { "type": "string", "minLength": 1 },
          "description": "Optional high-level intent identifiers supported by the agent."
        },
        "async": {
          "type": "boolean",
          "description": "Whether the agent supports asynchronous execution."
        },
        "supports_callbacks": {
          "type": "boolean",
          "description": "Whether the agent supports callbacks for async results."
        },
        "callback_modes": {
          "type": "array",
          "items": { "type": "string", "minLength": 1 },
          "description": "Supported callback modes (e.g., 'webhook', 'subscription', 'poll')."
        }
      }
    },

    "schema": {
      "type": "object",
      "additionalProperties": true,
      "properties": {
        "graphql_schema_url": {
          "type": "string",
          "format": "uri",
          "description": "Optional URL to a GraphQL schema document."
        },
        "mcp_manifest_url": {
          "type": "string",
          "format": "uri",
          "description": "Optional URL to an MCP manifest document."
        },
        "rest_openapi_url": {
          "type": "string",
          "format": "uri",
          "description": "Optional URL to an OpenAPI document describing REST endpoints."
        },
        "introspection": {
          "type": "boolean",
          "description": "Whether GraphQL schema introspection is enabled (informational)."
        }
      }
    },

    "limits": {
      "type": "object",
      "additionalProperties": true,
      "properties": {
        "max_concurrent_tasks": {
          "type": "number",
          "minimum": 0,
          "description": "Optional concurrency limit (informational)."
        },
        "max_task_ttl_seconds": {
          "type": "number",
          "minimum": 0,
          "description": "Optional max TTL for tasks (informational)."
        },
        "rate_limit_per_minute": {
          "type": "number",
          "minimum": 0,
          "description": "Optional rate limit hint (informational)."
        }
      }
    },

    "security": {
      "type": "object",
      "additionalProperties": true,
      "properties": {
        "issuer": {
          "type": "string",
          "format": "uri",
          "description": "Optional issuer identifier for tokens/signing context."
        },
        "jwks_url": {
          "type": "string",
          "format": "uri",
          "description": "Optional JWKS URL for verifying JWT/JWS signatures."
        },
        "signature": {
          "type": "string",
          "minLength": 1,
          "description": "Optional detached or embedded signature (format unspecified)."
        },
        "metadata_signature": {
          "type": "string",
          "minLength": 1,
          "description": "Optional indicator or value for AX document signing (format unspecified)."
        }
      }
    },

    "extensions": {
      "type": "object",
      "additionalProperties": true,
      "description": "Namespaced vendor or community extensions. Consumers should ignore unknown extensions."
    }
  }
}
